---
title: "AutoHotkeyに雑用を食わせるイロハ"
emoji: "👌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["AutoHotkey","Tech","小説"]
published: false
---
# 但し書き
この記事に提示しているサンプルスクリプトは、すべて動作未確認となります。
あらかじめご了承ください。

# やったこと
「選択した文字列をクリップボードにコピーし、その前後を引数で挟んで返す」関数を用意した。
クリップボードへの登録は Ctrl+C で行う。
Ctrl+C 後にクリップボードが 0 文字だったら(=無選択だったら)単に引数を返して、カーソルをひとつ前に送る。
Ctrl+C 後、クリップボード内に改行が入っていたら、上記と同様の処理を行う。

```ahk:WrapBracket.ahk
WrapBracket(x,y){
  Backup := ClipboardAll
  Clipboard =
  Send, ^c
  Sleep,50
  IfInString, Clipboard, `r`n
  {
    Clipboard =
    ClipStatus := 0 ;からっぽのカッコが送られるので0
  }Else if (Clipboard = ""){
    ClipStatus := 0
  }else{
    ClipStatus := 1 ;中身があるので1
    #if
  }
;  StringReplace, Clipboard, Clipboard, `r`n, , All
  Sleep,50
  Clipboard = %x%%Clipboard%%y%
  Sleep, 50
  Send,^v
  Sleep,50
  if (ClipStatus = 0){
    send,{Left}
  }Else{
    #If
  }
  Clipboard := Backup
  ClipStatus =
}
```

呼び出しはこうする。

```ahk:AutoHotkey.ahk
sc07B & k::
WrapBracket("「","」")
Return
```

# どうしてこんな処理をしているのか
AutoHotkey の欠点のひとつとして、クリップボード周りの処理が遅い・不確実という事情がある。
選択範囲を取得するのにクリップボードが不可欠だが、そのクリップボードを編集するためにリソースを食うのだ。

クリップボードの中身を変数に格納し、アレコレ編集した上で再度クリップボードに放り込むほうが、ずっとスマートに済む。

# 今後の展望
この記事は「入門編」だ。
当然、後方にはいろいろな記事が控えている。

職場やネカフェで執筆するのに必須、Windows の機能と絡めた『ボスが来た』機能実装のアレコレだとか。
AutoHotkey はアイデア次第でいくらでも便利にできるので飽きない。

興味が湧いたという物好きな人はここから AutoHotkey を落としてインストールしよう。
https://www.autohotkey.com/
共に世界の支配構造を打ち砕こうではないか。