---
title: "Pull Request駆動で小説を開発する"
emoji: "🇵🇷"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["GitHub","VSCode","VSCode拡張機能","textlint","Tech"]
published: false
---
##  謝辞
先日、こんな記事を書いた。
https://zenn.dev/haoblackj/articles/8cbadb26ca16e4
ありがたいことに多くの反応をいただいた。
この場を借りて御礼申し上げる。

# 要点
- Pull Request 駆動で小説を開発する
  - 情報整理の場としての Pull Request
  - 校正の場としての Pull Request

# Pull Request 駆動で小説を開発する
:::message
ここでは敢えて平易な表現を優先する。
:::
小説を書いて GitHub にアップロード(コミット→プッシュ)していく中で、「こういう表現にしたほうがよくなるんじゃないか」と思いつくことがある。
GitHub ではいつでも過去のデータにアクセスして文章を取り戻せるから、大掛かりな変更や修正も気軽にできる。

ただし、更新頻度の高いファイルになればなるほど、取り戻したい特定のタイミングを探し出す手間が増えるのは否めない。
コミットメッセージで**(ファイル名):どこそこを修正した**のように記載していたとしても、そのどこそこを別のタイミングで修正している可能性がある。
いちいち編集履歴を開き、原稿の該当部分を確認し、違ったら次の履歴へアクセスする。
これではファイル名で管理しているのと大差ない。

GitHub に残っていく編集履歴が、やがて快適さを妨げる負荷になる。
それを回避するために提案するのが、Pull Request 駆動での執筆だ。

##  Pull Request とは
> 分散バージョン管理システム（VCS）の機能の一つで、コードなどを追加・修正した際、本体への反映を他の開発者に依頼する機能。「変更を本人以外がレビューしてから反映させる」という手順を容易に実現することができる。
(プルリクエスト（マージリクエスト）とは - IT 用語辞典 e-Words 2021 年 2 月 7 日更新)

https://e-words.jp/w/%E3%83%97%E3%83%AB%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88.html#:~:text=%E3%83%97%E3%83%AB%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%81%A8%E3%81%AF%E3%80%81%E5%88%86%E6%95%A3,%E5%AE%9F%E7%8F%BE%E3%81%99%E3%82%8B%E3%81%93%E3%81%A8%E3%81%8C%E3%81%A7%E3%81%8D%E3%82%8B%E3%80%82

要は、過去のある時点の原稿と、たった今修正した原稿を比較できる仕組みだ。
比較した後、どちらか好きな方を**正**の原稿としてコミットできる機能(**マージ**)も備わっている。

##  Pull Request の使い方
1.  **元ブランチから修正用ブランチを発行する**

ブランチとはコミット履歴(原稿の編集履歴)のことだ。
GitHub はコミット履歴を枝分かれさせ、各々を比較する機能を備えている。
元ブランチ、すなわち修正前までのコミット履歴から修正用ブランチを枝分かれさせることで、修正前の原稿と修正後の原稿を比較できるように準備したというわけだ。

2.  **修正用ブランチ上で原稿を修正する**

原稿の修正作業に説明は不要のはずだ。
適宜修正し、コミットし、プッシュする。
コミット履歴は修正用ブランチ上に記録されていく。

3.  **修正用ブランチから元ブランチに対して Pull Request を発行する**

ある程度コミット履歴が蓄積されたら、いよいよ Pull Request を発行する。
修正用ブランチ上に記録されたコミットが一覧として表示され、最終的なファイルの変更箇所なども簡単に確認できるようになる。

4.  **Pull Request で修正を適用するか検討し、必要に応じて原稿を再修正する**

ここも説明は不要のはずだ。
適宜修正し、修正用ブランチにコミットし、プッシュする。
修正用ブランチにコミットするたび、Pull Request は自動で更新されていく。
(Pull Request 発行後、元ブランチにコミットしても自動では反映されないので注意)

5.  **修正が完了したら、修正用ブランチを元ブランチにマージする**

「Merge pull request」からマージすることで、修正用ブランチ上で修正した原稿が元ブランチに保存される。
必要に応じて修正用ブランチを削除したり、継続して使用したりする。
そのあたりの思想は千差万別なので、ここで言及はしない。
**GitHub Flow**で検索すると頭が痛くなること請け合いなので、検索してみるといい。


##  情報整理の場としての Pull Request
上記の流れで Pull Request を使っていくと、自ずとコミット履歴は整理されていく。
コミット履歴を直接確認するのではなく、当時作成した Pull Request から辿ればいいからだ。
Pull Request にはコメントを投稿する機能もあるから、それらを駆使すれば更にわかりやすく整理できる。
私の場合は、自分の原稿に対するツッコミや悩んでいることを適当に投稿している。

Pull Request のメリットは、コミット履歴をまとめられるというだけに留まらない。
コミット履歴が積み重なることで、ペースが目に見えてわかるようになる。
仮に原稿修正のペースが落ちてしまっても、コメントに案レベルの修正を書き込むことで進捗を生み出せる。
思いついた設定や伏線をコメントすることで、プロットへ転記する前に忘れてしまう悲劇を回避できる。

Pull Request はファイルごとに作成してもいいし、修正したい内容に応じて作成してもいい。
Issue にするほどでもない課題でも、Pull Request のコメントなら気軽に書き込んでしまっていい。
適当に作成して、適当に原稿を修正して、適当に情報を放り込んで、適当にマージする。
マージしたあとも Pull Request 自体は閲覧できるから、適宜そこから必要な情報にアクセスすればよい。