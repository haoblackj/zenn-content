---
title: "Windows式年遷宮スクリプト"
emoji: "✨"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["windows", "dotfiles", "powershell", "wsl", "winget"]
published: false
---

# 概要
- Windows の式年遷宮には喜びが伴う
- Windows を手軽にクリーンインストールするためのスクリプトを用意した
- ソフトウェアのインストールと設定ファイルの配置を自動化する

# 目的
Windows を手軽にクリーンインストールできる状態にしたい。

手軽にクリーンインストールできる状態とは、最小限の利用停止時間かつ最小の手間で、正常かついつもどおりに Windows を使用可能な状態にできる方法が確立していることをいう。

Windows を使っていると、「なんかよくわからんけど動きが悪いな」ということがある。
ソフトウェアを入れすぎて、システムドライブの容量が足りなくなることもある。
最近のローカル LLM ブームに乗っかって Anaconda だの pyenv だの Node.js だのを考えなしに突っ込んで、環境が汚くなっていくということもある。

こういうときに、サクッと手軽にクリーンインストールできる状態が整っていれば、原因究明に時間をかけずに済む。
仕事でこんなことを言えばぶっ飛ばされるが、自宅に設置した自己所有端末の話だ。自分の支出で購入した物品であるから、何をとやかく言われることもない。
仮にぶっ壊れても、自分が泣くだけで済む話だ。

ちなみに、最近はこういう環境整備のことを式年遷宮というらしい。

:::message
手軽にクリーンインストールできるということは、検証用環境を手軽に構築できるということでもある。
仮想マシンだけではなかなか再現しづらい不具合があるときに、クリーンインストールできる環境があると、検証が捗る。

※個人の感想。
:::

# 方針
このスクリプトの方針は、極力手動操作を避けることである。

- ソフトウェアの手動インストール
  - インストーラーをダウンロード→ダブルクリック→次へ→(N 回)→完了
- 設定ファイルの手動配置
  - 設定ファイルをコピー→ディレクトリを開く→ペースト→(必要に応じて)OS 再起動
  ※変更したらバックアップしなければならない、も追加。

いかにも面倒くさい。
偉い人は言いました、3 回同じことをやるなら自動化しろと。

なので、自動化しました。

# 実装要領
